<EXTREMELY_IMPORTANT>
# Issue Tracking Guide for Agents

Use `jig todo` CLI for all issue/task tracking. Never use TodoWrite or manual todo lists.

All commands support `--json` for machine-readable output.

## Workflow

BEFORE starting any task:
- Check for existing issues first. If none, create one: `jig todo create "Title" -t <type> -d "Description..." -s in-progress`
- Keep todo items current as you work (`- [ ]` → `- [x]`)
- ONLY mark completed when all items are checked: `jig todo update <id> -s completed`
- Include issue file(s) in commits

AFTER finishing:
- COMPLETING: add `## Summary of Changes` section
- SCRAPPING: add `## Reasons for Scrapping` section
- Offer to create follow-up issues for deferred work

## CLI Reference

```bash
# List
jig todo list --json                         # All issues
jig todo list --json --ready                 # Ready to start (not blocked/in-progress/completed/scrapped/draft)
jig todo list --json -t bug -s ready         # Filter by type/status
jig todo list --json -S "query"              # Full-text search

# Show (supports multiple IDs)
jig todo show --json <id> [id...]

# Create (always specify -t)
jig todo create --json "Title" -t task -d "Body..." -s ready

# Update
jig todo update --json <id> -s in-progress
jig todo update --json <id> --parent <id>
jig todo update --json <id> --blocking <id>
jig todo update --json <id> --blocked-by <id>
jig todo update --json <id> --body-replace-old "old" --body-replace-new "new"
jig todo update --json <id> --body-append "content"
jig todo update --json <id> -s completed --body-replace-old "- [ ] Task" --body-replace-new "- [x] Task"

# Archive (only when user requests)
jig todo archive
```

Run `jig todo <command> --help` for full options.
</EXTREMELY_IMPORTANT>

## create flags

`-t/--type` (required), `-s/--status` (default: ready), `-p/--priority`, `-d/--body` (`-` for stdin), `--body-file`, `--tag` (repeatable), `--due YYYY-MM-DD`, `--parent <id>`, `--blocking <id>` (repeatable), `--blocked-by <id>` (repeatable)

## update flags

`-s/--status`, `-t/--type`, `-p/--priority` (empty to clear), `--title`, `--due` (empty to clear), `--parent`/`--remove-parent`, `--blocking`/`--remove-blocking`, `--blocked-by`/`--remove-blocked-by`, `--tag`/`--remove-tag`, `--if-match <etag>`

## list flags

Filters: `-s/--status`, `--no-status`, `-t/--type`, `--no-type`, `-p/--priority`, `--no-priority`, `--tag`, `--no-tag`, `-S/--search`, `--ready`, `--is-blocked`, `--has-parent`, `--no-parent`, `--parent <id>` (all filter flags repeatable)
Output: `--sort` (created|updated|due|status|priority|id), `-q/--quiet` (IDs only), `--full` (include body)

## Relationships

- **Parent**: hierarchy (milestone → epic → feature → task/bug), set with `--parent <id>`
- **Blocking/Blocked-by**: dependency ordering; prefer `--blocked-by` when creating dependent work

## Issue Types
{{range .Types}}
- **{{.Name}}**{{if .Description}}: {{.Description}}{{end}}
{{- end}}

## Statuses
{{range .Statuses}}
- **{{.Name}}**{{if .Description}}: {{.Description}}{{end}}
{{- end}}

## Priorities

Use `-p` when creating, `--priority` when updating. Unset = normal.
{{range .Priorities}}
- **{{.Name}}**{{if .Description}}: {{.Description}}{{end}}
{{- end}}

## Body Modifications

Replace text (exact match, must occur once): `--body-replace-old "old" --body-replace-new "new"` (empty new = delete)
Append: `--body-append "content"` (`-` for stdin)
Both can combine with metadata flags in a single update.

Multiple replacements via GraphQL:
```bash
jig todo query 'mutation {
  updateIssue(id: "<id>", input: {
    status: "completed"
    bodyMod: {
      replace: [
        { old: "- [ ] Task 1", new: "- [x] Task 1" }
        { old: "- [ ] Task 2", new: "- [x] Task 2" }
      ]
      append: "## Summary\n\nDone!"
    }
  }) { id body etag }
}'
```

## Sync (External Integrations)
{{if .HasSync}}
This project syncs with: {{range $i, $name := .SyncNames}}{{if $i}}, {{end}}**{{$name}}**{{end}}. Config is in `.jig.yaml` under `sync:`.
{{- end}}
`jig todo sync` pushes issues to an external tracker (GitHub Issues or ClickUp) configured in `.jig.yaml` under `sync:`. Run `jig todo sync --help` for setup and usage.

## Concurrency Control

`jig todo show <id> --etag-only` → `jig todo update <id> --if-match "$ETAG" ...`

## GraphQL

`jig todo query` supports advanced queries/mutations. Use `--help` for syntax, `--schema` for full schema.

```bash
jig todo query --json '{ issues(filter: { excludeStatus: ["completed", "scrapped"], isBlocked: false }) { id title status type body } }'
jig todo query --json '{ issue(id: "abc") { title body parent { title } children { id title status } } }'
```
